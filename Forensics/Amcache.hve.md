## ‚úÖ **What is it?**

Amcache (`Amcache.hve`) is a Windows registry hive that **records information about executed applications, including their file paths, timestamps, and hashes**. Unlike Prefetch and ShimCache, **Amcache retains execution records even if Prefetch is disabled**.

Forensically, Amcache is useful because:

- It **tracks executed programs**, including those that have been deleted.
- It **stores SHA-1 hashes**, which helps in **malware detection**.
- It **records installation paths**, timestamps, and execution details.

> **‚ö†Ô∏è Limitations:**
> 
> - Does **not store execution timestamps directly**, but **stores modification timestamps**, which can help infer execution.
> - Only works for **executables (`.exe` files)**, not scripts (`.bat`, `.ps1`).

---

## **üìç Where to Find It?**

- **File Path:**
    
    ```
    C:\Windows\AppCompat\Programs\Amcache.hve
    ```
    
- **Registry Key:**
    
    ```
    HKLM\SYSTEM\CurrentControlSet\Services\bam\UserSettings
    ```
    

---

## **üõ†Ô∏è How to Extract It (Step by Step)**

We'll use **AmcacheParser**, a widely used forensic tool for parsing Amcache data.

### **Method 1: Manual Extraction**

1. **Copy the Amcache File**
    
    - Open **Command Prompt as Administrator**.
    - Copy the file to a safe location for analysis:
        
        ```cmd
        copy C:\Windows\AppCompat\Programs\Amcache.hve C:\Temp\Amcache.hve
        ```
        
    - If access is denied, change permissions:
        
        ```cmd
        takeown /F C:\Windows\AppCompat\Programs\Amcache.hve
        icacls C:\Windows\AppCompat\Programs\Amcache.hve /grant Administrators:F
        ```
        
2. **View Raw Data with Registry Viewer**
    
    - Open **Registry Explorer** (part of Eric Zimmerman's tools).
    - Load the `Amcache.hve` file and navigate through entries.

---

### **Method 2: Automated Extraction with AmcacheParser**

#### **1Ô∏è‚É£ Download AmcacheParser**

- Get it from **[Eric Zimmerman's repository](https://ericzimmerman.github.io/)**.
- Extract the zip file and navigate to the directory containing `AmcacheParser.exe`.

#### **2Ô∏è‚É£ Run AmcacheParser**

Open **Command Prompt** and navigate to the tool‚Äôs folder:

```cmd
cd C:\Path\To\AmcacheParser
```

Run the extraction command:

```cmd
AmcacheParser.exe -f C:\Temp\Amcache.hve -o C:\ExtractedResults
```

- `-f` specifies the Amcache file location.
- `-o` defines the output directory for parsed data.

#### **3Ô∏è‚É£ Review Output**

- The parsed data will be in `.csv` format.
- Open it in **Excel** or **Notepad++** for analysis.

---

## **üìä How to Analyze It (Step by Step)**

|**Step**|**Action**|**Details**|
|---|---|---|
|**1. Open the Parsed Output**|Load the `.csv` report generated by AmcacheParser|Use Excel or a forensic text editor for better readability|
|**2. Identify Executed Programs**|Look at the `Full Path` column|Lists all **executed** `.exe` files on the system|
|**3. Review SHA-1 Hashes**|Check the `SHA1` column|Cross-reference hashes with **VirusTotal** to detect malware|
|**4. Analyze File Installation Timestamps**|Look at the `Last Modified` timestamp|Helps infer when a program was installed or used|
|**5. Check for Deleted Files**|Programs may still appear in Amcache even if deleted from disk|Useful for **tracking malware that self-deletes**|
|**6. Cross-Reference with Prefetch and ShimCache**|Compare results across artifacts|If a program appears in **Amcache but not Prefetch**, it might have been executed long ago|

---

## **üö® Real-World Use Cases**

### **üìå Incident Response**

- Confirm whether a **malicious executable** was executed, even if the file was deleted.
- Identify **persistence mechanisms** by checking **installation paths** of unwanted programs.

### **üìå Malware Analysis**

- Use **SHA-1 hashes** to quickly verify if a program is **malware** using VirusTotal.
- Determine **how malware was installed** by checking timestamps and paths.

### **üìå Insider Threat Investigations**

- Detect **unauthorized software installation** by employees.
- Track **unusual application executions** (e.g., password crackers, hacking tools).

---

## **üîé Summary**

|**Category**|**Details**|
|---|---|
|**Location**|`C:\Windows\AppCompat\Programs\Amcache.hve`|
|**File Type**|Registry Hive|
|**Extraction Tool**|`AmcacheParser`|
|**Key Information**|Installed/Executed applications, SHA-1 hashes, timestamps|
|**Forensic Value**|Tracks historical execution of applications|

---
