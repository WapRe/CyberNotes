## ‚úÖ **What is it?**

Windows Event Logs (`.evtx`) are **structured system logs** that record security events, application behavior, system changes, and user activity. They are **one of the most valuable sources** in forensic investigations because they provide:

- **Login attempts (successful & failed)**.
- **Process creation & execution logs**.
- **Security policy changes**.
- **File and registry modifications**.
- **Network activity**.

> **‚ö†Ô∏è Limitations:**
> 
> - Logs **can be cleared** by attackers to hide their traces.
> - Some logs are disabled by default and need **pre-configuration** (e.g., **Sysmon logs**).

---

## **üìç Where to Find It?**

Windows Event Logs are stored in:

```
C:\Windows\System32\winevt\Logs\
```

Each log file has a `.evtx` extension.

### **Common Event Logs & Their Importance**

|**Log Name**|**Log Path**|**Forensic Use**|
|---|---|---|
|**Security Log**|`Security.evtx`|Tracks logins, privilege escalation, failed access attempts.|
|**System Log**|`System.evtx`|Records system startup/shutdown, service failures, hardware issues.|
|**Application Log**|`Application.evtx`|Logs application crashes, errors, and key software activity.|
|**PowerShell Log**|`Microsoft-Windows-PowerShell/Operational.evtx`|Tracks PowerShell script execution (important for malware detection).|
|**Sysmon Log**|`Microsoft-Windows-Sysmon/Operational.evtx`|Provides detailed process, network, and registry change logging.|
|**RDP Log**|`Microsoft-Windows-TerminalServices-LocalSessionManager/Operational.evtx`|Tracks remote desktop connections.|

---

## **üõ†Ô∏è How to Extract It (Step by Step)**

We will use **WevtxEcmd** (Eric Zimmerman's tool) to extract and parse logs.

### **Method 1: Manual Collection**

1. **Copy Log Files from the System**
    
    - Open **File Explorer**.
    - Navigate to: `C:\Windows\System32\winevt\Logs\`
    - Copy the required `.evtx` files to a forensic workstation.
2. **Export Logs Using Event Viewer**
    
    - Open **Event Viewer (`eventvwr.msc`)**.
    - Go to `Windows Logs > Security` (or other relevant logs).
    - Right-click **Save All Events As‚Ä¶** and save it as `.evtx`.

---

### **Method 2: Automated Extraction with EvtxECmd**

#### **1Ô∏è‚É£ Download EvtxECmd**

- Download from **[Eric Zimmerman's GitHub](https://ericzimmerman.github.io/)**.
- Extract to a working directory.

#### **2Ô∏è‚É£ Run EvtxECmd**

Navigate to the tool's directory and run:

```cmd
EvtxECmd.exe -d C:\Windows\System32\winevt\Logs\ -o C:\ExtractedResults
```

- `-d` specifies the directory containing the logs.
- `-o` defines the output folder for extracted reports.

#### **3Ô∏è‚É£ Review Extracted Data**

- The tool generates **CSV files** with all parsed event logs.
- Open in **Excel** to filter and analyze key events.

---

## **üìä How to Analyze It (Step by Step)**

|**Step**|**Action**|**Details**|
|---|---|---|
|**1. Open the Parsed Log File**|Load the `.csv` file generated by EvtxECmd|Use Excel or a forensic text editor.|
|**2. Identify Suspicious Logins**|Filter `Event ID 4624` (Successful Logon) and `4625` (Failed Logon)|Helps track unauthorized access attempts.|
|**3. Check Process Execution**|Look for `Event ID 4688` (New Process Created)|Tracks suspicious script execution (`powershell.exe`, `cmd.exe`).|
|**4. Investigate System Changes**|Look for `Event ID 1102` (Audit Log Cleared)|Attackers may delete logs to cover their tracks.|
|**5. Analyze RDP Connections**|Look for `Event ID 4624` (Logon Type 10)|Tracks remote desktop sessions.|
|**6. Correlate with Other Artifacts**|Compare with Prefetch, Amcache, and ShimCache|Provides full execution context.|

---

## **üö® Real-World Use Cases**

### **üìå Incident Response**

- Identify **brute-force attacks** by checking multiple failed login attempts (`Event ID 4625`).
- Detect **unauthorized process execution** (`Event ID 4688` - suspicious PowerShell scripts).

### **üìå Malware Analysis**

- Check if a **malicious payload** executed via `cmd.exe` or `powershell.exe`.
- Identify **network connections made by malware** using Sysmon logs.

### **üìå Insider Threat Investigations**

- Track **unauthorized RDP access** (`Event ID 4624`, Logon Type 10).
- Find **USB device connections** (`Event ID 4663` - file access logs).

---

## **üîé Summary**

|**Category**|**Details**|
|---|---|
|**Location**|`C:\Windows\System32\winevt\Logs\`|
|**File Type**|`.evtx`|
|**Extraction Tool**|`EvtxECmd`|
|**Key Information**|Logins, process execution, system changes, remote access|
|**Forensic Value**|Tracks user activity, security events, and malware execution|

---
